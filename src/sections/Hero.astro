---
import {fetchGraphQL} from "../lib/wp-client";

interface HeroData {
    pageBy: {
        hero: {
            heroTitle: string;
            heroSubtitle: string;
            heroDescription: string;
            heroBackgroundImage: {
                node: {
                    mediaItemUrl: string;
                };
            };
        };
    };
}

const HERO_QUERY = `
  query GetHeroComponent {
      pageBy(uri: "homepage") {
        hero {
          heroTitle
          heroSubtitle
          heroDescription
          heroBackgroundImage {
            node {
              mediaItemUrl
            }
          }
        }
      }
    }
`;

let heroData: HeroData | null = null;
try {
    heroData = await fetchGraphQL<HeroData>(HERO_QUERY);
} catch (error) {
    console.error('Error fetching hero data:', error);
}

// Imagen de respaldo si no hay imagen en WordPress
const defaultBg = "/default-hero.jpg"; // Pon aqu√≠ la ruta de tu imagen por defecto en /public
const heroBgUrl = heroData?.pageBy?.hero?.heroBackgroundImage?.node?.mediaItemUrl || defaultBg;
const {heroTitle, heroSubtitle, heroDescription} = heroData?.pageBy?.hero || {};
---

<section
        class="relative flex flex-col items-center justify-center min-h-[80vh] w-full text-center text-white bg-center rounded-xl mb-8"
        style={`background-image: url('${heroBgUrl}'); background-size: cover; background-position: center;`}
>
    <div class="absolute inset-0 bg-black opacity-60 z-0 rounded-xl"></div>
    <div class="relative z-10 flex flex-col items-center justify-center w-full h-full p-5">
        <h1 class="text-5xl md:text-6xl xl:text-[96px] font-extrabold md:leading-tight xl:leading-[144px]">{heroTitle}</h1>
        <h2 class="text-3xl md:text-5xl xl:text-[48px] font-semibold lg:leading-[72px] mb-12">{heroSubtitle}</h2>
        <h3 class="text-xl md:text-3xl xl:text-[28px] font-medium lg:leading-[41px]">{heroDescription}</h3>
    </div>
    <div class="scroll-arrow absolute left-1/2 bottom-8 z-20 transform -translate-x-1/2">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
            <path d="M12 5v14M12 19l-7-7M12 19l7-7" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </div>
</section>

<script>
    import gsap from "gsap";

    gsap.from("h1", {
        opacity: 0,
        y: -50,
        duration: 1.5,
        ease: "power3.out"
    });

    gsap.from("h2", {
        opacity: 0,
        y: -30,
        delay: 0.5,
        duration: 1.5,
        ease: "power3.out"
    });

    gsap.from("h3", {
        opacity: 0,
        y: -20,
        delay: 1,
        duration: 1.5,
        ease: "power3.out"
    });

    gsap.to(".scroll-arrow", {
        y: 20,
        repeat: -1,
        yoyo: true,
        duration: 1,
        ease: "power1.inOut"
    });
</script>
