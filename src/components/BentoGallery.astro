---
import {fetchGraphQL} from "../lib/wp-client";

interface GalleryImage {
    node: {
        sourceUrl: string;
    };
}

interface GalleryData {
    pageBy: {
        gallery: {
            image1: GalleryImage;
            image2: GalleryImage;
            image3: GalleryImage;
            image4: GalleryImage;
            image5: GalleryImage;
            image6: GalleryImage;
            image7: GalleryImage;
            image8: GalleryImage;
        };
    };
}

const GALLERY_QUERY = `
  query GetGallery {
    pageBy(uri: "homepage") {
      gallery {
        image1 { node { sourceUrl } }
        image2 { node { sourceUrl } }
        image3 { node { sourceUrl } }
        image4 { node { sourceUrl } }
        image5 { node { sourceUrl } }
        image6 { node { sourceUrl } }
        image7 { node { sourceUrl } }
        image8 { node { sourceUrl } }
      }
    }
  }
`;

let galleryData: GalleryData | null = null;
try {
    galleryData = await fetchGraphQL<GalleryData>(GALLERY_QUERY);
} catch (error) {
    console.error("Error fetching gallery data:", error);
}

const { gallery } = galleryData?.pageBy || {};
const galleryImages = gallery ? Object.values(gallery).filter(image => image?.node?.sourceUrl) : [];

// Imagen placeholder por defecto si no hay imágenes
const placeholderImage = '/kids_home.png';

// Función helper para obtener la URL de la imagen o el placeholder
const getImageUrl = (index: number): string => {
    return galleryImages[index]?.node?.sourceUrl || placeholderImage;
};
---

<h3 class="text-white text-5xl leading-[71px] font-extrabold text-left mx-5">
    Nuestra galería de fotos
</h3>
<div class="mx-5 mb-5">
    <div class="grid grid-cols-2 grid-rows-10 gap-4 lg:hidden">
        <div class="row-span-2 shadow-xl">
            <img class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(0)} alt="" width="400" height="300" loading="lazy" />
        </div>
        <div class="row-span-3 col-start-1 row-start-3">
            <img alt="gallery" class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(1)} width="400" height="450" loading="lazy" />
        </div>
        <div class="row-span-2 col-start-1 row-start-6">
            <img alt="gallery" class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(2)} width="400" height="300" loading="lazy" />
        </div>
        <div class="row-span-3 col-start-1 row-start-8">
            <img alt="gallery" class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(3)} width="400" height="450" loading="lazy" />
        </div>
        <div class="row-span-3 col-start-2 row-start-1">
            <img alt="gallery" class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(4)} width="400" height="450" loading="lazy" />
        </div>
        <div class="row-span-2 col-start-2 row-start-4">
            <img alt="gallery" class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(5)} width="400" height="300" loading="lazy" />
        </div>
        <div class="row-span-3 col-start-2 row-start-6">
            <img alt="gallery" class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(6)} width="400" height="450" loading="lazy" />
        </div>
        <div class="row-span-2 col-start-2 row-start-9">
            <img alt="gallery" class="block object-cover object-center w-full h-full rounded-lg" src={getImageUrl(7)} width="400" height="300" loading="lazy" />
        </div>
    </div>

    <div class="hidden lg:grid grid-cols-4 grid-rows-5 gap-4">
        <div class="row-span-2 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(0)} alt="" width="300" height="240" loading="lazy" />
        </div>

        <div class="row-span-3 col-start-1 row-start-3 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(1)} alt="" width="300" height="360" loading="lazy" />
        </div>
        <div class="row-span-3 col-start-2 row-start-1 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(2)} alt="" width="300" height="360" loading="lazy" />
        </div>
        <div class="row-span-2 col-start-2 row-start-4 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(3)} alt="" width="300" height="240" loading="lazy" />
        </div>
        <div class="row-span-2 col-start-3 row-start-1 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(4)} alt="" width="300" height="240" loading="lazy" />
        </div>
        <div class="row-span-3 col-start-3 row-start-3 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(5)} alt="" width="300" height="360" loading="lazy" />
        </div>
        <div class="row-span-3 col-start-4 row-start-1 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(6)} alt="" width="300" height="360" loading="lazy" />
        </div>
        <div class="row-span-2 col-start-4 row-start-4 rounded-lg overflow-hidden group cursor-pointer">
            <img class="block object-cover object-center w-full h-full rounded-lg transition-transform duration-300 ease-in-out group-hover:scale-110" src={getImageUrl(7)} alt="" width="300" height="240" loading="lazy" />
        </div>
    </div>
</div>